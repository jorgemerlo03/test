<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CV — Jorge Merlo</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg-start:#0f172a; --bg-end:#111827; --brand:#7c3aed; --brand-2:#22d3ee;
      --text:#e5e7eb; --muted:#9aa3b2; --radius:18px; --shadow:0 20px 40px rgba(0,0,0,.35);
    }
    body{
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial; color:var(--text);
      background:radial-gradient(120% 140% at 10% 0%, #0b1220, transparent 60%),
                 linear-gradient(180deg,var(--bg-start),var(--bg-end));
    }
    .navbar{backdrop-filter:blur(10px); background:rgba(15,23,42,.6)!important; border-bottom:1px solid rgba(255,255,255,.06)}
    .nav-link{color:var(--text)!important; opacity:.85} .nav-link:hover{opacity:1}
    .btn-cta{background:linear-gradient(135deg,var(--brand),var(--brand-2)); color:#0b1220; font-weight:700; border:none}
    .section{padding:56px 0}
    .glass{background:rgba(255,255,255,.04); border:1px solid rgba(255,255,255,.08); border-radius:var(--radius); box-shadow:var(--shadow)}
    .section-title{font-weight:800} .text-muted-2{color:var(--muted)}
    .badge-soft{border:1px dashed rgba(255,255,255,.18); color:var(--muted); border-radius:999px; padding:.35rem .7rem; display:inline-flex; gap:.5rem; align-items:center}
    .badge-soft .dot{width:8px;height:8px;border-radius:999px;background:linear-gradient(135deg,var(--brand),var(--brand-2))}
    /* Mock de PDF con imagen */
    .pdf-mock{background:#0b1220; padding:12px; border-radius:14px}
    .pdf-page{background:#fff; border-radius:8px; box-shadow:0 8px 24px rgba(0,0,0,.35); overflow:hidden}
    .pdf-page img{width:100%; max-height:80vh; object-fit:contain; display:block}
    /* Iframe visor */
    .ratio > iframe{border:none; border-radius:12px; background:#0b1220}

    /* ====== NEON TRAIL FULL-PAGE ====== */
    #glowCanvas{
      position: fixed; inset: 0; width: 100vw; height: 100vh;
      z-index: 0; pointer-events: none;
    }
    body > *:not(#glowCanvas){ position: relative; z-index: 1; }
   
    @media (max-width: 768px){ #glowCanvas{ display:none; } }
    @media (prefers-reduced-motion: reduce){ #glowCanvas{ display:none; } }



  </style>
</head>
<body>

  <!-- CANVAS GLOBAL DEL EFECTO -->
  <canvas id="glowCanvas" aria-hidden="true"></canvas>

  <!-- NAV -->
  <nav class="navbar navbar-expand-sm navbar-dark sticky-top">
    <div class="container">
      <a class="navbar-brand d-flex align-items-center gap-2" href="./about.html">
        <span style="width:32px;height:32px;border-radius:8px;background:linear-gradient(135deg,var(--brand),var(--brand-2));display:inline-block"></span>
        Jorge Merlo
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsEx">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarsEx">
        <ul class="navbar-nav ms-auto align-items-center gap-2">
          <li class="nav-item"><a class="nav-link" href="./about.html">Sobre mí</a></li>
          <li class="nav-item"><a class="nav-link active" href="./resume.html">CV</a></li>
          <li class="nav-item"><a class="nav-link" href="./projects.html">Proyectos</a></li>
          <li class="nav-item"><a class="nav-link" href="./contact.html">Contacto</a></li>
          <li class="nav-item"><a class="btn btn-cta ms-sm-2" href="./contact.html">Contrátame</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- HEADER -->
  <header class="section pb-3">
    <div class="container">
      <span class="badge-soft mb-3"><span class="dot"></span> Módulo — CV</span>
      <h1 class="section-title display-6">Mi Currículum</h1>
    </div>
  </header>

  <!-- VISOR -->
  <main class="section pt-3">
    <div class="container">
      <div class="glass p-3 p-md-4">
        <!-- Visor PDF (solo si el archivo existe) -->
        <div id="pdfViewer" class="ratio ratio-16x9 d-none">
          <iframe id="cvFrame" title="CV PDF" allowfullscreen referrerpolicy="no-referrer"></iframe>
        </div>

        <!-- Mock con imagen -->
        <div id="imgViewer" class="pdf-mock">
          <div class="pdf-page">
            <img id="cvImg" src="./assets/cv/cv-preview.png" alt="Vista previa del CV">
          </div>
        </div>

        <div class="d-flex flex-wrap gap-2 mt-3">
          <a id="downloadBtn" class="btn btn-outline-light" href="./assets/cv/jorge-merlo-cv.pdf" download>Descargar PDF</a>
          <a id="openBtn" class="btn btn-cta" href="./assets/cv/jorge-merlo-cv.pdf" target="_blank" rel="noopener">Abrir en pestaña nueva</a>
        </div>
      </div>
    </div>
  </main>

  <!-- FOOTER -->
  <footer class="py-4 mt-4" style="border-top:1px solid rgba(255,255,255,.08)">
    <div class="container d-flex flex-column flex-sm-row align-items-center justify-content-between gap-2">
      <small class="text-muted-2">© <span id="y"></span> Jorge Merlo. Hecho con Bootstrap.</small>
      <a href="./index.html" class="link-light">Volver al inicio</a>
    </div>
  </footer>

  <!-- SCRIPT EXISTENTE (visor PDF + fallback imagen) -->
  <script>
    document.getElementById('y').textContent = new Date().getFullYear();

    // Rutas RELATIVAS (importante para GitHub Pages en subcarpeta)
    const PDF_PATH = './assets/cv/jorge-merlo-cv.pdf';
    const IMG_PATH = './assets/cv/cv-preview.png';

    const pdfViewer = document.getElementById('pdfViewer');
    const imgViewer = document.getElementById('imgViewer');
    const frame = document.getElementById('cvFrame');
    const openBtn = document.getElementById('openBtn');
    const downloadBtn = document.getElementById('downloadBtn');
    const cvImg = document.getElementById('cvImg');

    // Si falla la imagen, que se note y no colapse la altura
    cvImg.onerror = () => {
      cvImg.alt = 'No se encontró ./assets/cv/cv-preview.png';
      cvImg.style.minHeight = '300px';
      cvImg.style.background = '#0b1220';
    };

    // Detectar si existe el PDF con HEAD; si existe, usar visor PDF
    fetch(PDF_PATH, { method: 'HEAD' })
      .then(res => {
        if (res.ok) {
          frame.src = PDF_PATH + '#zoom=FitH';
          pdfViewer.classList.remove('d-none');
          imgViewer.classList.add('d-none');
          openBtn.href = PDF_PATH;
          downloadBtn.href = PDF_PATH;
        } else {
          openBtn.href = IMG_PATH;
          downloadBtn.href = IMG_PATH;
          downloadBtn.setAttribute('download','jorge-merlo-cv.png');
        }
      })
      .catch(() => {
        openBtn.href = IMG_PATH;
        downloadBtn.href = IMG_PATH;
        downloadBtn.setAttribute('download','jorge-merlo-cv.png');
      });
  </script>

  <!-- NEON FLUID TRAIL (full page, sutil) -->
  <script>
  (function(){
    const canvas = document.getElementById('glowCanvas');
    if(!canvas) return;
    const ctx = canvas.getContext('2d', { alpha:true });

    let dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
    function resize(){
      canvas.width  = Math.floor(window.innerWidth  * dpr);
      canvas.height = Math.floor(window.innerHeight * dpr);
      ctx.setTransform(dpr,0,0,dpr,0,0);
    }
    resize(); addEventListener('resize', resize);

     const trail = [];
    const MAX  = 30;        // menor densidad
    const FADE = 0.16;      // se disipa más rápido
    const SIZE = [26,50];   // más pequeñas [max,min]
    let lastGen = 0;

    let mouse = { x: window.innerWidth/2, y: window.innerHeight/2 };
    const addPoint = (x,y)=>{ trail.push({ x, y, life:1, seed: Math.random()*360 }); if(trail.length>MAX) trail.shift(); };

    addEventListener('mousemove', e=>{ mouse.x=e.clientX; mouse.y=e.clientY; addPoint(mouse.x,mouse.y); }, {passive:true});
    addEventListener('touchmove', e=>{ const t=e.touches[0]; mouse.x=t.clientX; mouse.y=t.clientY; addPoint(mouse.x,mouse.y); }, {passive:true});

    const lerp=(a,b,t)=>a+(b-a)*t;
    const hue = t => (t*60)%360; // ciclo HSL

    function tick(t){
      ctx.globalCompositeOperation = 'source-over';
      ctx.fillStyle = `rgba(15,23,42,${FADE})`;
      ctx.fillRect(0,0,canvas.width,canvas.height);

      ctx.globalCompositeOperation = 'lighter';
      if (t - lastGen > 45){ addPoint(mouse.x, mouse.y); lastGen = t; }

      for(const p of trail){
        p.life *= 0.965;
        const r = lerp(SIZE[1], SIZE[0], 1 - p.life);
        const g = ctx.createRadialGradient(p.x, p.y, 0, p.x, p.y, r);
        const hh = (p.seed + hue(t/1000)) % 360;
        g.addColorStop(0, `hsla(${hh},95%,65%,${0.12*p.life})`);
        g.addColorStop(1, `hsla(${hh},95%,65%,0)`);
        ctx.fillStyle = g;
        ctx.beginPath(); ctx.arc(p.x, p.y, r, 0, Math.PI*2); ctx.fill();
      }
      for(let i=trail.length-1;i>=0;i--) if(trail[i].life<0.02) trail.splice(i,1);

      requestAnimationFrame(tick);
    }
    requestAnimationFrame(tick);
  })();
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
